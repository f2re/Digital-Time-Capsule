# План реализации интеграции новой фичи с основным флоу

**Общий прогресс:** 100%

## Задачи:

- ✅ Шаг 1: Проверить все сообщения в старом флоу и заменить на вызовы из translations.py
  - ✅ Проверить файл src/handlers/main_menu.py на жестко закодированные строки
  - ✅ Проверить файл src/handlers/create_capsule.py на жестко закодированные строки
  - ✅ Проверить файл src/handlers/view_capsules.py на жестко закодированные строки
  - ✅ Проверить файл src/handlers/subscription.py на жестко закодированные строки
  - ✅ Проверить файл src/handlers/help.py на жестко закодированные строки
  - ✅ Проверить файл src/handlers/settings.py на жестко закодированные строки
  - ✅ Проверить файл src/handlers/onboarding.py на жестко закодированные строки

- ✅ Шаг 2: Обновить все прямые обращения к базе данных до функций в database.py
  - ✅ Найти все прямые SQL запросы в handler файлов
  - ✅ Заменить их на вызовы соответствующих функций в database.py
  - ✅ Добавить недостающие функции в database.py при необходимости

- ✅ Шаг 3: Интегрировать новую фичу (онбординг) с основным меню флоу
  - ✅ Определить точки интеграции онбординга с основым флоу
  - ✅ Реализовать проверки onboarding_stage в старте бота
  - ✅ Создать вариации флоу для пользователей на разных стадиях онбординга

- ✅ Шаг 4: Реализовать все возможные вариации флоу
  - ✅ Флоу для новых пользователей (не прошедших онбординг)
  - ✅ Флоу для пользователей в процессе онбординга
  - ✅ Флоу для пользователей, завершивших онбординг
  - ✅ Обработка пропущенного онбординга
  - ✅ Обработка досрочного выхода из онбординга

- ✅ Шаг 5: Обновить plan.md с прогрессом выполнения
  - ✅ Отметить выполненные шаги в реальном времени
  - ✅ Обновлять процент выполнения по мере реализации